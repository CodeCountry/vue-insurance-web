webpackJsonp([21],{DG8I:function(e,n,l){"use strict";function o(e){l("I8uc")}Object.defineProperty(n,"__esModule",{value:!0});var r=l("fZjL"),t=l.n(r),a=(l("mtWM"),{data:function(){return{isAble:!0,isProduct:!1,editLoading:!1,formInline:{brandId:"",category:"",file:"",filename:"",startLine:"2",dealerNameColumn:"A",vinColumn:"B",modelColumn:"C",nameColumn:"D",colorColumn:"E",dealerCodeColumn:"F",madeAtColumn:"G"},dataArr:[],titleArr:[],categoryArr:[],rules:{brandId:[{required:!0,message:"请选择品牌",trigger:"blur"}],category:[{required:!0,message:"请选择品类",trigger:"blur"}],startLine:[{required:!0,message:"请输入数据开始行",trigger:"blur"}],vinColumn:[{required:!0,message:"请输入车架号所在列",trigger:"blur"}],file:[{required:!0,message:"请上传文件",trigger:"blur"}]}}},created:function(){var e=this;e.$api.get("/brand/option/all",null,function(n){console.log(n.data),200===n.code?(e.titleArr=n.data,1===n.data.length&&(e.formInline.brandId=n.data[0].id,e.sendProduct())):alert(n.message)})},methods:{uploadFile:function(e){this.formInline.file=e.target.files[0],this.formInline.filename=e.target.files[0].name},sendProduct:function(){var e=this;e.formInline.category="",e.$api.get("brandconfig/brand/"+e.formInline.brandId+"/category",null,function(n){if(console.log(n.data),200===n.code){e.dataArr="",e.categoryArr=n.data,e.isProduct=!0;for(var l in n.data)1===t()(n.data).length&&(e.formInline.category=l)}else alert(n.message)})},onSubmit:function(e){var n=this,l=this;l.$refs.formInline.validate(function(o){if(!o)return console.log("error submit!!"),!1;if(n.formInline.file.size/1024/1024<=5){n.editLoading=!0;var r=new FormData;r.append("brandId",l.formInline.brandId),r.append("category",l.formInline.category),r.append("startLine",l.formInline.startLine),r.append("dealerNameColumn",l.formInline.dealerNameColumn),r.append("vinColumn",l.formInline.vinColumn),r.append("modelColumn",l.formInline.modelColumn),r.append("nameColumn",l.formInline.nameColumn),r.append("colorColumn",l.formInline.colorColumn),r.append("dealerCodeColumn",l.formInline.dealerCodeColumn),r.append("madeAtColumn",l.formInline.madeAtColumn),r.append("file",l.formInline.file),console.log(r),l.$api.post("/vehicle/uploadVehicleNew",r,function(o){console.log(o.data),200===o.code?(alert(o.message),l.dataArr=o.data,l.$refs[e].resetFields(),document.getElementById("file").value="",l.formInline.filename=""):alert(o.message),n.editLoading=!1},function(e){n.$router.push({path:"/login"})})}else alert("上传文件不能超过2MB,请重新上传")})}}}),i=function(){var e=this,n=e.$createElement,l=e._self._c||n;return l("div",[l("div",{staticClass:"top"},[l("div",{staticClass:"title",staticStyle:{"margin-bottom":"20px"}},[e._v("导入车架号\n      ")]),e._v(" "),l("el-form",{ref:"formInline",attrs:{inline:!0,model:e.formInline,rules:e.rules}},[l("el-form-item",{attrs:{label:"品牌",prop:"brandId"}},[l("el-select",{attrs:{placeholder:"品牌"},on:{change:function(n){e.sendProduct()}},model:{value:e.formInline.brandId,callback:function(n){e.$set(e.formInline,"brandId",n)},expression:"formInline.brandId"}},e._l(e.titleArr,function(e){return l("el-option",{key:e.id,attrs:{label:e.name,value:e.id}})}))],1),e._v(" "),e.isProduct?l("el-form-item",{attrs:{label:"品类",prop:"category"}},[l("el-select",{attrs:{name:"category",placeholder:"品类"},model:{value:e.formInline.category,callback:function(n){e.$set(e.formInline,"category",n)},expression:"formInline.category"}},e._l(e.categoryArr,function(e,n){return l("el-option",{key:n,attrs:{label:e,value:n}})}))],1):e._e(),e._v(" "),l("el-form-item",{attrs:{label:"开始行",prop:"startLine"}},[l("el-input",{attrs:{placeholder:"请输入数据开始行"},model:{value:e.formInline.startLine,callback:function(n){e.$set(e.formInline,"startLine",n)},expression:"formInline.startLine"}})],1),e._v(" "),l("el-form-item",{attrs:{label:"经销商名称",prop:"dealerNameColumn"}},[l("el-input",{attrs:{placeholder:"请输入经销商名称所在列"},model:{value:e.formInline.dealerNameColumn,callback:function(n){e.$set(e.formInline,"dealerNameColumn",n)},expression:"formInline.dealerNameColumn"}})],1),e._v(" "),l("el-form-item",{attrs:{label:"车架号",prop:"vinColumn"}},[l("el-input",{attrs:{placeholder:"请输入车架号所在列"},model:{value:e.formInline.vinColumn,callback:function(n){e.$set(e.formInline,"vinColumn",n)},expression:"formInline.vinColumn"}})],1),e._v(" "),l("el-form-item",{attrs:{label:"车型号",prop:"modelColumn"}},[l("el-input",{attrs:{placeholder:"请输入车型号所在列"},model:{value:e.formInline.modelColumn,callback:function(n){e.$set(e.formInline,"modelColumn",n)},expression:"formInline.modelColumn"}})],1),e._v(" "),l("el-form-item",{attrs:{label:"车型名称",prop:"nameColumn"}},[l("el-input",{attrs:{placeholder:"请输入车型名称所在列"},model:{value:e.formInline.nameColumn,callback:function(n){e.$set(e.formInline,"nameColumn",n)},expression:"formInline.nameColumn"}})],1),e._v(" "),l("el-form-item",{attrs:{label:"颜色",prop:"colorColumn"}},[l("el-input",{attrs:{placeholder:"请输入颜色所在列"},model:{value:e.formInline.colorColumn,callback:function(n){e.$set(e.formInline,"colorColumn",n)},expression:"formInline.colorColumn"}})],1),e._v(" "),l("el-form-item",{attrs:{label:"经销商编码",prop:"dealerCodeColumn"}},[l("el-input",{attrs:{placeholder:"请输入经销商编码所在列"},model:{value:e.formInline.dealerCodeColumn,callback:function(n){e.$set(e.formInline,"dealerCodeColumn",n)},expression:"formInline.dealerCodeColumn"}})],1),e._v(" "),l("el-form-item",{attrs:{label:"出厂时间",prop:"madeAtColumn"}},[l("el-input",{attrs:{placeholder:"请输入出厂时间所在列"},model:{value:e.formInline.madeAtColumn,callback:function(n){e.$set(e.formInline,"madeAtColumn",n)},expression:"formInline.madeAtColumn"}})],1),e._v(" "),l("el-form-item",{attrs:{label:"选择订单文件",prop:"file"}},[l("div",{staticClass:"upload_file"},[l("input",{ref:"file",attrs:{type:"file",name:"file",id:"file"},on:{change:e.uploadFile}}),e._v(" "),l("input",{staticClass:"submit_style",attrs:{type:"button",size:"small",value:"上传文件"}})]),e._v(" "),l("div",{staticClass:"fileName",staticStyle:{display:"inline"},domProps:{textContent:e._s(e.formInline.filename)}})]),e._v(" "),l("el-form-item",[e.editLoading?l("el-button",{directives:[{name:"loading",rawName:"v-loading",value:e.editLoading,expression:"editLoading"}],attrs:{type:"primary",size:"medium",disabled:""}},[e._v("上传到服务器")]):l("el-button",{attrs:{type:"primary",size:"medium"},on:{click:function(n){e.onSubmit("formInline")}}},[e._v("上传到服务器")]),e._v(" "),l("div",{staticStyle:{display:"inline"}},[e._v("只能上传.xlsx/.xls文件，且不超过5MB")])],1)],1),e._v(" "),l("el-form",{attrs:{inline:!0}},e._l(e.dataArr,function(n){return l("div",{staticStyle:{color:"red"},domProps:{textContent:e._s(n)}})}))],1)])},m=[],d={render:i,staticRenderFns:m},s=d,u=l("VU/8"),f=o,c=u(a,s,!1,f,null,null);n.default=c.exports},I8uc:function(e,n,l){var o=l("UlHT");"string"==typeof o&&(o=[[e.i,o,""]]),o.locals&&(e.exports=o.locals);l("rjj0")("f1f4be12",o,!0)},UlHT:function(e,n,l){n=e.exports=l("FZ+f")(!1),n.push([e.i,"\n.submit_style{\n  padding:8px 12px;\n  border:none;\n  background-color: #409eff;\n  border-radius: 3px;\n  color: #fff;\n}\n.submit_style:focus, .submit_style:hover {\n  color: #fff;\n  border-color: #66b1ff;\n  background-color:#66b1ff;\n}\n.download{\n  display: inline-block;\n  padding: 8px 12px;\n  border: none;\n  background-color: #409eff;\n  border-radius: 3px;\n  color: #fff;\n  font-size: 13px;\n}\n",""])}});