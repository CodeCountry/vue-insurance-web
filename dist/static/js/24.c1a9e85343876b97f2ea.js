webpackJsonp([24],{UpAm:function(t,e,o){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var l=o("woOf"),a=o.n(l),n={data:function(){return{form:{name:""},tableDataUser:[],tableDataAu:[],userOptions:[],chooseUser:[],list:[],auOptions:[],chooseAu:[],loading:!0}},created:function(){var t=this,e=this;e.form.roleId=localStorage.getItem("roleId"),e.$api.get("/role/"+e.form.roleId,null,function(t){if(console.log(t.data),200===t.code){e.form.name=t.data.name,e.tableDataUser=t.data.users,e.tableDataAu=t.data.rights;for(var o=0;o<e.tableDataUser.length;o++){var l=e.tableDataUser[o].createdAt;e.tableDataUser[o].createdAt=e.getDate(l)}e.loading=!1}else alert(t.message)},function(e){t.$router.push({path:"/login"})})},methods:{remoteMethodUser:function(t){var e=this;if(""!==t){this.loading=!0;var o=this;setTimeout(function(){o.$api.get("/user/keyword/"+t,null,function(t){if(console.log(t.data),200===t.code){if(o.list=t.data.content,0!==t.data.content.length)for(var l=0;l<t.data.content.length;l++)o.list[l].label=t.data.content[l].fullName,o.list[l].value=t.data.content[l].id,o.userOptions=o.list;else o.userOptions=o.list;e.loading=!1}else alert(t.message)},function(t){e.$router.push({path:"/login"})})},500)}else this.userOptions=[]},remoteMethodAu:function(t){var e=this;if(""!==t){this.loading=!0;var o=this;setTimeout(function(){o.$api.get("/right/keyword/"+t,null,function(t){if(console.log(t.data),200===t.code){if(o.list=t.data.content,0!==t.data.content.length)for(var l=0;l<t.data.content.length;l++)o.list[l].label=t.data.content[l].name,o.list[l].value=t.data.content[l].id,o.auOptions=o.list;else o.auOptions=o.list;e.loading=!1}else alert(t.message)},function(t){e.$router.push({path:"/login"})})},500)}else this.auOptions=[]},addUser:function(){var t=this,e=this;console.log("要添加的是"+e.chooseUser);var o={roleId:e.form.roleId,userIds:e.chooseUser};e.$api.post("/role/users",o,function(t){console.log(t.data),200===t.code?(e.$router.go(0),e.$message({message:"操作成功！",type:"success"})):alert(t.message)},function(e){t.$router.push({path:"/login"})})},addAu:function(){var t=this,e=this;console.log("要添加的是"+e.chooseAu);var o={roleId:e.form.roleId,rightIds:e.chooseAu};e.$api.post("/role/rights",o,function(t){200===t.code?(e.$router.go(0),e.$message({message:"操作成功！",type:"success"})):alert(t.message)},function(e){t.$router.push({path:"/login"})})},deleteUser:function(t){var e=this;this.$confirm("确认删除吗？","提示",{confirmButtonText:"确定",cancelButtonText:"取消",cancelButtonClass:"cancel"}).then(function(){var o=e;o.form=a()({},t),console.log(o.form.id),o.form.roleId=localStorage.getItem("roleId"),o.$api.delete("/role/user?roleId="+o.form.roleId+"&userId="+o.form.id,null,function(t){200===t.code?o.$router.go(0):alert(t.message)},function(t){e.$router.push({path:"/login"})})}).catch(function(){})},deleteAu:function(t){var e=this;this.$confirm("确认删除吗？","提示",{confirmButtonText:"确定",cancelButtonText:"取消",cancelButtonClass:"cancel"}).then(function(){var o=e;o.form=a()({},t),console.log(o.form.id),o.form.roleId=localStorage.getItem("roleId"),o.$api.delete("/role/right?roleId="+o.form.roleId+"&rightId="+o.form.id,null,function(t){200===t.code?o.$router.go(0):alert(t.message)},function(t){e.$router.push({path:"/login"})})}).catch(function(){})}}},r=function(){var t=this,e=t.$createElement,o=t._self._c||e;return o("section",[o("el-row",[o("div",{staticClass:"tit",staticStyle:{"font-weight":"600","margin-bottom":"20px"}},[t._v("当前角色名:"),o("span",[t._v(t._s(t.form.name))])])]),t._v(" "),o("el-row",[o("el-col",{staticStyle:{"margin-right":"15px"},attrs:{span:11}},[o("div",{staticClass:"tit"},[t._v("用户列表")]),t._v(" "),o("div",[o("el-select",{staticClass:"tit",staticStyle:{width:"70%"},attrs:{multiple:"",filterable:"",remote:"",placeholder:"请输入关键词添加","remote-method":t.remoteMethodUser,loading:t.loading},model:{value:t.chooseUser,callback:function(e){t.chooseUser=e},expression:"chooseUser"}},t._l(t.userOptions,function(t){return o("el-option",{key:t.value,attrs:{label:t.label,value:t.value}})})),t._v(" "),o("el-button",{attrs:{type:"primary"},on:{click:t.addUser}},[t._v("确定添加")])],1),t._v(" "),o("el-table",{staticStyle:{width:"100%"},attrs:{data:t.tableDataUser,border:""}},[o("el-table-column",{attrs:{type:"index",label:"序号",width:"50"}}),t._v(" "),o("el-table-column",{attrs:{prop:"name",label:"账户"}}),t._v(" "),o("el-table-column",{attrs:{prop:"fullName",label:"全名"}}),t._v(" "),o("el-table-column",{attrs:{prop:"createdAt",label:"创建日期"}}),t._v(" "),o("el-table-column",{attrs:{label:"操作",fixed:"right",width:"100"},scopedSlots:t._u([{key:"default",fn:function(e){return[o("el-button",{attrs:{size:"mini",type:"danger"},on:{click:function(o){t.deleteUser(e.row)}}},[t._v("删除用户")])]}}])})],1)],1),t._v(" "),o("el-col",{staticStyle:{"margin-left":"15px"},attrs:{span:11}},[o("div",{staticClass:"tit"},[t._v("权限列表")]),t._v(" "),o("div",[o("el-select",{staticClass:"tit",staticStyle:{width:"70%"},attrs:{multiple:"",filterable:"",remote:"",placeholder:"请输入关键词添加","remote-method":t.remoteMethodAu,loading:t.loading},model:{value:t.chooseAu,callback:function(e){t.chooseAu=e},expression:"chooseAu"}},t._l(t.auOptions,function(t){return o("el-option",{key:t.value,attrs:{label:t.label,value:t.value}})})),t._v(" "),o("el-button",{attrs:{type:"primary"},on:{click:t.addAu}},[t._v("确定添加")])],1),t._v(" "),o("el-table",{staticStyle:{width:"100%"},attrs:{data:t.tableDataAu,border:""}},[o("el-table-column",{attrs:{type:"index",label:"序号",width:"50"}}),t._v(" "),o("el-table-column",{attrs:{prop:"name",label:"权限名"}}),t._v(" "),o("el-table-column",{attrs:{prop:"conditions",label:"条件"}}),t._v(" "),o("el-table-column",{attrs:{prop:"entity",label:"操作对象"}}),t._v(" "),o("el-table-column",{attrs:{prop:"type",label:"类型",width:"80"}}),t._v(" "),o("el-table-column",{attrs:{label:"操作",fixed:"right",width:"90"},scopedSlots:t._u([{key:"default",fn:function(e){return[o("el-button",{attrs:{size:"mini",type:"danger"},on:{click:function(o){t.deleteAu(e.row)}}},[t._v("删除权限")])]}}])})],1)],1)],1)],1)},s=[],i={render:r,staticRenderFns:s},c=i,u=o("VU/8"),d=u(n,c,!1,null,null,null);e.default=d.exports}});